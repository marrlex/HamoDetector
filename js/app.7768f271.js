(function(e){function t(t){for(var a,r,o=t[0],l=t[1],c=t[2],u=0,m=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&m.push(n[r][0]),n[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);d&&d(t);while(m.length)m.shift()();return s.push.apply(s,c||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],a=!0,r=1;r<i.length;r++){var l=i[r];0!==n[l]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=i[0]))}return e}var a={},n={app:0},s=[];function r(e){return o.p+"js/"+({about:"about"}[e]||e)+"."+{about:"2f739020","chunk-0d7e7468":"9c94f0ad","chunk-2d0a32e5":"c8c4b268","chunk-2d0c4e26":"d439e341","chunk-2d0cfde9":"0bc789d3","chunk-2d0da2e9":"d45a7393","chunk-2d0e2921":"6bf86b94","chunk-2d2228ce":"af574f37","chunk-2d22dbab":"40966c47","chunk-5f4e2479":"5e61c92c","chunk-70765d52":"2adc3af2","chunk-dab9ea0e":"a9e86294"}[e]+".js"}function o(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise((function(t,a){i=n[e]=[t,a]}));t.push(i[2]=a);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=r(e);var c=new Error;s=function(t){l.onerror=l.onload=null,clearTimeout(u);var i=n[e];if(0!==i){if(i){var a=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",c.name="ChunkLoadError",c.type=a,c.request=s,i[1](c)}n[e]=void 0}};var u=setTimeout((function(){s({type:"timeout",target:l})}),12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(t)},o.m=e,o.c=a,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(i,a,function(t){return e[t]}.bind(null,a));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=c;s.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("cd49")},"13ae":function(e,t,i){"use strict";var a=i("b095"),n=i.n(a);n.a},4826:function(e,t,i){"use strict";var a=i("8f1e"),n=i.n(a);n.a},"5a8e":function(e,t,i){},"82fe":function(e,t,i){"use strict";var a=i("e897"),n=i.n(a);n.a},"8f1e":function(e,t,i){},"90fe":function(e,t,i){},b095:function(e,t,i){},b3ac:function(e,t,i){"use strict";var a=i("5a8e"),n=i.n(a);n.a},cd49:function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a,n=i("2b0e"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("v-navigation-drawer",{attrs:{clipped:"",app:"",temporary:""},model:{value:e.navBar,callback:function(t){e.navBar=t},expression:"navBar"}},[i("v-list",e._l(e.drawerItems,(function(t){return i("v-list-item",{key:t.title,attrs:{dark:e.settings.general.items.colorTheme.value},on:{click:function(i){return e.$router.push(t.to)}}},[i("v-list-item-icon",[i("v-icon",{domProps:{textContent:e._s(t.icon)}})],1),i("v-list-item-content",[i("v-list-item-title",{domProps:{textContent:e._s(t.title)}})],1)],1)})),1)],1),i("v-app-bar",{attrs:{dense:"",dark:e.settings.general.items.colorTheme.value,app:"",width:"100vw"}},[i("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.navBar=!e.navBar}}}),i("v-toolbar-title",[e._v("アンミー")]),i("v-spacer"),i("v-btn",{attrs:{dark:e.settings.general.items.colorTheme.value,icon:""},on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}},[i("v-icon",[e._v("settings")])],1)],1),i("v-navigation-drawer",{attrs:{temporary:"",right:"",app:"",dark:e.settings.general.items.colorTheme.value},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[i("v-list",{attrs:{dense:"",dark:e.settings.general.items.colorTheme.value}},[i("v-subheader",{staticClass:"text-subtitle-1"},[e._v("設定")]),e._l(e.settings,(function(t){return i("v-list-group",{key:t.title,attrs:{"prepend-icon":t.action,"no-action":""},scopedSlots:e._u([{key:"activator",fn:function(){return[i("v-list-item-content",[i("v-list-item-title",{domProps:{textContent:e._s(t.title)}})],1)]},proxy:!0}],null,!0),model:{value:t.active,callback:function(i){e.$set(t,"active",i)},expression:"item.active"}},[i("v-container",{attrs:{fluid:""}},e._l(t.items,(function(t){return i("v-row",{key:t.title,attrs:{"no-gutters":"",justify:"space-between"}},[i("v-col",[i("v-subheader",[e._v(" "+e._s(t.title)+" "),"slider"in t?i("span",[e._v("： "+e._s(t.value))]):e._e()]),"slider"in t?i("v-slider",{attrs:{min:t.slider.min,max:t.slider.max,"append-icon":"add","prepend-icon":"remove"},on:{"click:append":function(e){t.value++},"click:prepend":function(e){t.value--}},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"subItem.value"}}):e._e()],1),"select"in t?i("v-col",[i("v-select",{attrs:{items:t.select,dense:""},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"subItem.value"}})],1):e._e(),t.switch?i("v-col",[i("v-switch",{staticClass:"mt-1",attrs:{dense:""},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"subItem.value"}})],1):e._e()],1)})),1),i("v-divider")],1)}))],2)],1),i("v-main",{staticStyle:{height:"100vh"}},[i("v-container",{staticClass:"overflow-y-auto",staticStyle:{height:"100%"},attrs:{fluid:""}},[i("router-view")],1)],1)],1)},r=[],o=(i("5363"),i("90fe"),i("d1e78"),i("99af"),i("cb29"),i("4de4"),i("c975"),i("d81d"),i("fb6a"),i("b0c0"),i("4ec9"),i("90d7"),i("d3b7"),i("6062"),i("3ca3"),i("ddb0"),i("3835")),l=i("2909"),c=i("b85c"),u=["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"],d=new Map([["major",[1,25/24,9/8,1.2,5/4,4/3,25/18,1.5,25/16,5/3,1.8,15/8]],["minor",[1,1.08,9/8,1.2,5/4,4/3,1.44,1.5,1.6,5/3,1.8,15/8]]]),m=new Map,h=Object(c["a"])(d);try{for(h.s();!(a=h.n()).done;){var v=Object(o["a"])(a.value,2),f=v[0],p=v[1];m.set(f,p.map((function(e,t){return 12*Math.log2(e/Math.pow(2,t/12))*100})))}}catch($t){h.e($t)}finally{h.f()}var y=[{notes:new Set([0,4,7]),name:""},{notes:new Set([0,3,7]),name:"m"},{notes:new Set([0,5,7]),name:"sus4"},{notes:new Set([0,2,7]),name:"sus2"},{notes:new Set([0,4,8]),name:"aug"},{notes:new Set([0,3,6]),name:"dim"},{notes:new Set([0,4,7,10]),name:"7"},{notes:new Set([0,3,7,10]),name:"m7"},{notes:new Set([0,4,7,11]),name:"M7"},{notes:new Set([0,3,6,10]),name:"m7-5"},{notes:new Set([0,5,7,10]),name:"7sus4"},{notes:new Set([0,3,7,11]),name:"mM7"},{notes:new Set([0,4,7,9]),name:"6"},{notes:new Set([0,3,7,9]),name:"m6"},{notes:new Set([0,4,6,10]),name:"7-5"}];function g(e,t){var i,a=Object(c["a"])(t);try{for(a.s();!(i=a.n()).done;){var n=i.value;if(!e.has(n))return!1}}catch($t){a.e($t)}finally{a.f()}return!0}var b=21,w=12;function x(e){var t=e.midiNoteNumber,i=void 0===t?21:t,a=e.isMajor,n=void 0===a||a,s=e.scaleKeyNumber,r=void 0===s?-1:s,o=e.stdFreq,l=void 0===o?442:o,c=l/Math.pow(2,4);if(r<0)return c*Math.pow(2,(i-b)/w);var u=r+b,m=(w+i-u)%w,h=d.get(n?"major":"minor"),v=c*Math.pow(2,r/w),f=v*h[m],p=Math.floor((i-b-r)/w);return f*Math.pow(2,p)}function k(e,t){var i=u.indexOf(e);if(i<0)return Array(w).fill(0);var a=m.get(t?"major":"minor"),n=[a.slice(0,-i),a.slice(-i)],s=n[0],r=n[1];return[].concat(Object(l["a"])(r),Object(l["a"])(s))}function N(e){var t=Object(l["a"])(e);t.sort((function(e,t){return e>t?1:-1}));for(var i=Object(l["a"])(new Set(t.map((function(e){return e%w})))),a=function(e,t){return t>e?t-e:(w+t-e)%w},n=[],s=function(e){for(var t=new Set,s=0;s<i.length;s++)t.add(a(i[0],i[s]));var r,o=y.filter((function(e){return g(t,e.notes)})),l=[],d=Object(c["a"])(o);try{for(d.s();!(r=d.n()).done;){var m=r.value;l.push({scaleName:u[i[0]],chordName:m.name,isMajor:!t.has(3)})}}catch($t){d.e($t)}finally{d.f()}l.reverse(),n.push.apply(n,l),i.push(i[0]),i.shift()},r=0;r<i.length;r++)s(r);return n}function C(e,t){window.localStorage.setItem(e,JSON.stringify(t))}var S=JSON.parse(window.localStorage.getItem("settings")),_=JSON.parse(window.localStorage.getItem("settings")),M=JSON.parse(window.localStorage.getItem("toneConfig")),T=n["a"].extend({name:"App",data:function(){var e,t,i,a,n,s,r,o,l,c,u,d;return{drawer:!1,drawerItems:{harmony:{title:"ハーモニー",to:"/",icon:"mdi-piano"},learning:{title:"純正律について",to:"/learning",icon:"mdi-music-circle-outline"},about:{title:"このアプリについて",to:"/about",icon:"mdi-information-outline"}},navBar:!1,settings:{general:{title:"一般",active:!1,items:{autoKeySelect:{title:"調の自動選択",value:(null===S||void 0===S||null===(e=S.items)||void 0===e||null===(t=e.autoKeySelect)||void 0===t?void 0:t.value)||!0,switch:!0},displayCent:{title:"セント値を表示",value:(null===S||void 0===S||null===(i=S.items)||void 0===i||null===(a=i.displayCent)||void 0===a?void 0:a.value)||!1,switch:!0},baseFrequency:{title:"基本周波数",value:(null===S||void 0===S||null===(n=S.items)||void 0===n||null===(s=n.baseFrequency)||void 0===s?void 0:s.value)||442,slider:{min:435,max:445}},colorTheme:{title:"ダークモード",value:(null===S||void 0===S||null===(r=S.items)||void 0===r||null===(o=r.colorTheme)||void 0===o?void 0:o.value)||!1,switch:!0}}},toneColor:{title:"音形",active:!1,items:{attack:{title:"アタック",value:(null===_||void 0===_||null===(l=_.items)||void 0===l||null===(c=l.attack)||void 0===c?void 0:c.value)||50,slider:{min:0,max:100}},release:{title:"リリース",value:(null===_||void 0===_||null===(u=_.items)||void 0===u||null===(d=u.release)||void 0===d?void 0:d.value)||50,slider:{min:0,max:100}}}}},playingMidiNoteNumbers:[],toneConfig:{waveform:(null===M||void 0===M?void 0:M.waveform)||"sine",sustainMethod:(null===M||void 0===M?void 0:M.sustainMethod)||"momentary",isMajor:null==(null===M||void 0===M?void 0:M.isMajor)||(null===M||void 0===M?void 0:M.isMajor),musicalKey:(null===M||void 0===M?void 0:M.musicalKey)||"平均律",toneRange:(null===M||void 0===M?void 0:M.toneRange)||2},harmony:[{chordName:"",scaleName:""}],isVirtualKeyboardShown:!1,analyser:void 0}},watch:{playingMidiNoteNumbers:function(){var e=N(this.playingMidiNoteNumbers);e.length>0&&(this.harmony=e,this.settings.general.items.autoKeySelect.value&&(this.toneConfig.musicalKey=e[0].scaleName,this.toneConfig.isMajor=e[0].isMajor))},"settings.general":{handler:function(e){C(e.title,e)},deep:!0},"settings.toneColor":{handler:function(e){C(e.title,e)},deep:!0},toneConfig:{handler:function(e){C("toneConfig",e)},deep:!0}}}),j=T,$=i("2877"),V=i("6544"),K=i.n(V),I=i("7496"),A=i("40dc"),P=i("5bc1"),O=i("8336"),B=i("62ad"),q=i("a523"),F=i("ce7e"),R=i("132d"),E=i("8860"),D=i("56b0"),G=i("da13"),L=i("5d23"),J=i("34c3"),H=i("f6c4"),W=i("f774"),z=i("0fd9"),U=i("b974"),X=i("ba0d"),Y=i("2fa4"),Q=i("e0c7"),Z=i("b73d"),ee=i("2a7f"),te=Object($["a"])(j,s,r,!1,null,"10b8f0a8",null),ie=te.exports;K()(te,{VApp:I["a"],VAppBar:A["a"],VAppBarNavIcon:P["a"],VBtn:O["a"],VCol:B["a"],VContainer:q["a"],VDivider:F["a"],VIcon:R["a"],VList:E["a"],VListGroup:D["a"],VListItem:G["a"],VListItemContent:L["a"],VListItemIcon:J["a"],VListItemTitle:L["b"],VMain:H["a"],VNavigationDrawer:W["a"],VRow:z["a"],VSelect:U["a"],VSlider:X["a"],VSpacer:Y["a"],VSubheader:Q["a"],VSwitch:Z["a"],VToolbarTitle:ee["a"]});var ae=i("9483");Object(ae["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(e){console.log("New content is downloading."),e.update()},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var ne=i("8c4f"),se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"overflow-y-auto",staticStyle:{height:"100%"},attrs:{fluid:""}},[i("v-row",{attrs:{wrap:"",dense:""}},[i("v-col",{style:"width: "+e.$vuetify.breakpoint.thresholds.md,attrs:{cols:"12",md:"12",lg:"6","order-lg":"4","order-xl":"4","order-sm":"first","order-md":"first"}},[i("harmony-display",{staticStyle:{"max-height":"100%"},attrs:{dark:e.settings.general.items.colorTheme.value,matchChords:e.harmony,isMajor:e.toneConfig.isMajor,musicalKey:e.toneConfig.musicalKey,displayCent:e.settings.general.items.displayCent.value}}),i("oscilloscope",{attrs:{dark:e.settings.general.items.colorTheme.value,analyserNode:e.analyser}})],1),i("v-col",{style:"width: "+e.$vuetify.breakpoint.thresholds.md,attrs:{cols:"12",md:"6",lg:"3","order-lg":"first","order-xl":"first","order-sm":"7","order-md":"7"}},[i("tonecolor-card",{staticStyle:{"max-height":"100%"},attrs:{dark:e.settings.general.items.colorTheme.value,waveform:e.toneConfig.waveform,sustainMethod:e.toneConfig.sustainMethod,toneRange:e.toneConfig.toneRange,isMajor:e.toneConfig.isMajor,musicalKey:e.toneConfig.musicalKey},on:{"update:waveform":function(t){return e.$set(e.toneConfig,"waveform",t)},"update:sustainMethod":function(t){return e.$set(e.toneConfig,"sustainMethod",t)},"update:sustain-method":function(t){return e.$set(e.toneConfig,"sustainMethod",t)},"update:toneRange":function(t){return e.$set(e.toneConfig,"toneRange",t)},"update:tone-range":function(t){return e.$set(e.toneConfig,"toneRange",t)},"update:isMajor":function(t){return e.$set(e.toneConfig,"isMajor",t)},"update:is-major":function(t){return e.$set(e.toneConfig,"isMajor",t)},"update:musicalKey":function(t){return e.$set(e.toneConfig,"musicalKey",t)},"update:musical-key":function(t){return e.$set(e.toneConfig,"musicalKey",t)}}})],1),i("v-col",{style:"width: "+e.$vuetify.breakpoint.thresholds.md,attrs:{cols:"12",md:"6",lg:"3",order:"last"}},[i("metronome-card",{staticStyle:{"max-height":"100%"},attrs:{dark:e.settings.general.items.colorTheme.value,isVirtualKeyboardShown:e.isVirtualKeyboardShown},on:{"update:isVirtualKeyboardShown":function(t){e.isVirtualKeyboardShown=t},"update:is-virtual-keyboard-shown":function(t){e.isVirtualKeyboardShown=t}}})],1)],1),e.isVirtualKeyboardShown?e._e():i("v-footer",{staticStyle:{height:"40%","max-height":"50mm"},attrs:{padless:"",inset:"",app:""}},[i("v-container",{staticClass:"ma-0",staticStyle:{height:"100%",width:"100vw"},attrs:{fluid:""}},[i("piano-keyboard",{attrs:{startMidiNoteNumber:12*e.toneConfig.toneRange+24,interval:e.$vuetify.breakpoint.xs?13:e.$vuetify.breakpoint.mdAndDown?25:e.$vuetify.breakpoint.lg?37:49,isPressedIndexes:e.playingMidiNoteNumbers,sustainMethod:e.toneConfig.sustainMethod,wavetype:e.toneConfig.waveform,attackTimeConst:e.settings.toneColor.items.attack.value,releaseTimeConst:e.settings.toneColor.items.release.value,isMajor:e.toneConfig.isMajor,musicalKey:e.toneConfig.musicalKey,stdFrequency:e.settings.general.items.baseFrequency.value,analyser:e.analyser},on:{"update:analyser":function(t){e.analyser=t}}})],1)],1)],1)},re=[],oe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"piano-keyboard"},on:{pressKey:e.play,releaseKey:e.stop,mousedown:e.pressKey,mouseup:e.releaseKey,mouseleave:e.releaseKey,touchstart:function(t){return t.preventDefault(),e.pressKey(t)},touchmove:e.moveKey,touchend:e.releaseKey,touchcancel:e.releaseKey}},e._l(e.interval,(function(t){return i("piano-key",{key:t,attrs:{midiNoteNumber:t-1+e.startMidiNoteNumber,isPressed:e.isPressedIndexes.includes(t-1+e.startMidiNoteNumber),isWhite:[0,2,3,5,7,8,10].includes((t-1+e.startMidiNoteNumber-21)%12),interval:e.interval}})})),1)},le=[],ce=(i("caad"),i("a434"),i("a9e3"),i("2532"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"keyboards",class:{"keyboard-pressed":e.isPressed,"key-space":e.isKeySpace,"white-key":e.isWhite,"black-key":!e.isWhite},style:e.isWhite?"width: calc(100% / "+(e.interval-5*~~(e.interval/12))+");":"width: calc(70% / "+(e.interval-5*~~(e.interval/12))+"); margin-left: calc(-35% / "+(e.interval-5*~~(e.interval/12))+");",attrs:{toneName:e.toneName,octave:e.octave,midiNoteNumber:e.midiNoteNumber}})}),ue=[],de={name:"piano-key",props:{isPressed:Boolean,isKeySpace:Boolean,isWhite:Boolean,toneName:String,midiNoteNumber:Number,octave:Number,interval:Number},methods:{pressKey:function(){this.$emit("pressKey",this.midiNoteNumber)},releaseKey:function(){this.isPressed&&this.$emit("releaseKey",this.midiNoteNumber)},moveKey:function(e){console.log(e),this.isPressed||this.pressKey()}}},me=de,he=(i("b3ac"),Object($["a"])(me,ce,ue,!1,null,"66b62222",null)),ve=he.exports,fe=i("d4ec"),pe=i("bee2");window.AudioContext=window.AudioContext||window.webkitAudioContext;var ye=["A","Bb","B","C","C#","D","Eb","E","F","F#","G","Ab"],ge=function(){function e(t){var i=t.attackTimeConst,a=t.releaseTimeConst,n=t.isMajor,s=t.stdFreq,r=t.musicalKey,o=t.wavetype;Object(fe["a"])(this,e),this.audioCtx=new AudioContext,this.ana=this.audioCtx.createAnalyser(),this.ana.connect(this.audioCtx.destination),this.masterGain=this.audioCtx.createGain(),this.masterGain.gain.value=.1,this.masterGain.connect(this.ana),this.comp=this.audioCtx.createDynamicsCompressor(),this.comp.attack.value=0,this.comp.release.value=0,this.comp.connect(this.masterGain),this._attackTimeConst=i,this._releaseTimeConst=a,this._isMajor=n,this._stdFreq=s,this._wavetype=o,this._musicalKey=r,this.playingAudioNodes=new Map}return Object(pe["a"])(e,[{key:"play",value:function(e){var t=this.audioCtx,i=t.createOscillator(),a=t.createGain();this.playingAudioNodes.has(e)||this.playingAudioNodes.set(e,{osc:i,gain:a});var n=x({midiNoteNumber:e,isMajor:this._isMajor,scaleKeyNumber:ye.indexOf(this._musicalKey),stdFreq:this._stdFreq});i.frequency.value=n,i.type=this._wavetype,a.gain.setValueAtTime(0,t.currentTime),i.connect(a),a.connect(this.masterGain),i.start(t.currentTime),a.gain.linearRampToValueAtTime(1,t.currentTime+.002*(100-this._attackTimeConst))}},{key:"stop",value:function(e){var t=this.audioCtx,i=this.playingAudioNodes.get(e);if(void 0!==i){var a=i.osc,n=i.gain.gain,s=n.value;n.cancelScheduledValues(t.currentTime),n.setValueAtTime(s,t.currentTime),n.setTargetAtTime(0,t.currentTime,.002*this._releaseTimeConst),a.stop(t.currentTime+.01*this._releaseTimeConst),this.playingAudioNodes.delete(e)}}},{key:"clear",value:function(){var e,t=this.playingAudioNodes.keys(),i=Object(c["a"])(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;this.stop(a)}}catch($t){i.e($t)}finally{i.f()}}},{key:"close",value:function(){if(void 0!==this.audioCtx&&"running"!==this.audioCtx.state){var e=this.audioCtx;e.close()}}},{key:"replay",value:function(){var e,t=this.playingAudioNodes.keys(),i=Object(c["a"])(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,n=x({midiNoteNumber:a,isMajor:this._isMajor,scaleKeyNumber:ye.indexOf(this._musicalKey),stdFreq:this._stdFreq}),s=this.playingAudioNodes.get(a);if(void 0!=s){var r=this.audioCtx,o=s.osc;o.frequency.setValueAtTime(n,r.currentTime),o.type=this._wavetype}}}catch($t){i.e($t)}finally{i.f()}}},{key:"attackTimeConst",set:function(e){this._attackTimeConst=e,this.replay()}},{key:"releaseTimeConst",set:function(e){this._releaseTimeConst=e,this.replay()}},{key:"isMajor",set:function(e){this._isMajor=e,this.replay()}},{key:"stdFreq",set:function(e){this._stdFreq=e,this.replay()}},{key:"wavetype",set:function(e){this._wavetype=e,this.replay()}},{key:"musicalKey",set:function(e){this._musicalKey=e,this.replay()}}]),e}(),be=n["a"].extend({name:"piano-keyboard",data:function(){return{isMouseDown:!1,touchIdentifiers:new Map,willStopMidiNoteNumbers:new Map,audioCtx:void 0,masterGain:void 0,comp:void 0,audioNodes:new Map,harmonyPlayer:void 0}},props:{startMidiNoteNumber:Number,interval:Number,wavetype:String,attackTimeConst:Number,releaseTimeConst:Number,isMajor:Boolean,musicalKey:String,stdFrequency:Number,isPressedIndexes:Array,sustainMethod:String,analyser:AnalyserNode},components:{"piano-key":ve},methods:{play:function(e){var t;null===(t=this.harmonyPlayer)||void 0===t||t.play(e),this.isPressedIndexes.push(e),void 0===this.analyser&&void 0!==this.harmonyPlayer&&this.$emit("update:analyser",this.harmonyPlayer.ana)},stop:function(e){var t;null===(t=this.harmonyPlayer)||void 0===t||t.stop(e);var i=this.isPressedIndexes.indexOf(e);this.isPressedIndexes.splice(i,1)},clear:function(){var e;null===(e=this.harmonyPlayer)||void 0===e||e.clear(),this.isPressedIndexes.splice(0)},close:function(){var e;null===(e=this.harmonyPlayer)||void 0===e||e.close()},replay:function(){var e;null===(e=this.harmonyPlayer)||void 0===e||e.replay()},pressKey:function(e){if(void 0===this.harmonyPlayer){var t={attackTimeConst:this.attackTimeConst,releaseTimeConst:this.releaseTimeConst,isMajor:this.isMajor,stdFreq:this.stdFrequency,musicalKey:this.musicalKey,wavetype:this.wavetype};this.harmonyPlayer=new ge(t)}var i=e.target,a=i.attributes.getNamedItem("midiNoteNumber");if(null!=a){var n=Number(a.value);if("exclusive"===this.sustainMethod&&0===this.touchIdentifiers.size&&this.clear(),this.isPressedIndexes.includes(n))if("mousedown"===e.type)"alternative"===this.sustainMethod&&this.willStopMidiNoteNumbers.set(0,n);else{var s=e.targetTouches[0].identifier;this.touchIdentifiers.set(s,n),"alternative"===this.sustainMethod&&this.willStopMidiNoteNumbers.set(s,n)}else{if("mousedown"===e.type)this.isMouseDown=!0;else{var r=e.targetTouches[0].identifier;this.touchIdentifiers.set(r,n)}this.play(n)}}},moveKey:function(e){var t,i=Object(c["a"])(e.changedTouches);try{for(i.s();!(t=i.n()).done;){var a=t.value,n=a.identifier,s=document.elementFromPoint(a.pageX,a.pageY);if(null!=s){var r=s.attributes.getNamedItem("midiNoteNumber");if(null!=r){var o=Number(r.value),l=this.touchIdentifiers.get(n);this.touchIdentifiers.has(n)&&l!==o&&(this.stop(this.touchIdentifiers.get(n)),this.touchIdentifiers.set(n,o),this.isPressedIndexes.includes(o)?"alternative"===this.sustainMethod&&this.willStopMidiNoteNumbers.set(n,o):(this.play(o),"alternative"===this.sustainMethod&&this.willStopMidiNoteNumbers.delete(n)))}}else{var u=this.touchIdentifiers.get(n);void 0!=u&&(this.stop(u),this.touchIdentifiers.delete(n))}}}catch($t){i.e($t)}finally{i.f()}},releaseKey:function(e){if("mouseup"===e.type){this.isMouseDown=!1;var t=this.isPressedIndexes[0];switch(this.sustainMethod){case"momentary":this.stop(t);break;case"alternative":this.willStopMidiNoteNumbers.has(0)&&(this.stop(this.willStopMidiNoteNumbers.get(0)),this.willStopMidiNoteNumbers.delete(0));break;case"exclusive":break}}else if(/touch/.test(e.type)){var i=e.changedTouches[0].identifier;switch(this.sustainMethod){case"momentary":this.touchIdentifiers.has(i)&&this.stop(this.touchIdentifiers.get(i));break;case"alternative":this.willStopMidiNoteNumbers.has(i)&&(this.stop(this.willStopMidiNoteNumbers.get(i)),this.willStopMidiNoteNumbers.delete(i));break;case"exclusive":break}this.touchIdentifiers.delete(i)}}},watch:{sustainMethod:function(){"momentary"===this.sustainMethod&&this.clear()},musicalKey:function(e){void 0!==this.harmonyPlayer&&(this.harmonyPlayer.musicalKey=e)},isMajor:function(e){void 0!==this.harmonyPlayer&&(this.harmonyPlayer.isMajor=e)},wavetype:function(e){void 0!==this.harmonyPlayer&&(this.harmonyPlayer.wavetype=e)},stdFrequency:function(e){void 0!==this.harmonyPlayer&&(this.harmonyPlayer.stdFreq=e)}}}),we=be,xe=(i("4826"),Object($["a"])(we,oe,le,!1,null,"32ca3346",null)),ke=xe.exports,Ne=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{id:"metronome-card",dark:e.dark}},[i("v-card-text",[i("v-container",{staticClass:"overflow-y-auto pa-3",attrs:{fluid:""}},[i("v-row",{attrs:{"no-gutters":""}},[i("v-col",{attrs:{cols:"11"}},[i("v-row",{attrs:{"no-gutters":"",align:"center"}},[i("v-col",{attrs:{cols:"8","align-self":"center"}},[i("v-row",{attrs:{"no-gutters":"",align:"center"}},[i("v-col",{attrs:{cols:"auto"}},[i("v-icon",{on:{click:function(t){e.items.tempo.value--}}},[e._v("remove")])],1),i("v-col",{staticClass:"ml-2 mr-2",attrs:{cols:"auto"}},[i("span",{staticClass:"display-1 font-weight-light"},[e._v(e._s(e.items.tempo.value))]),i("span",{staticClass:"subheading font-weight-light ml-1"},[e._v("BPM")])]),i("v-col",{attrs:{cols:"auto"}},[i("v-icon",{on:{click:function(t){e.items.tempo.value++}}},[e._v("add")])],1)],1)],1)],1)],1),i("v-col",{attrs:{cols:"1"}},[i("v-btn",{attrs:{depressed:"",text:"",outlined:"",small:"",icon:""},on:{click:e.metroHandler}},[i("v-icon",[e._v(" "+e._s(e.isPlaying?"mdi-pause":"mdi-play")+" ")])],1)],1)],1),i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-slider",{attrs:{dense:"","hide-details":"",min:e.items.tempo.slider.min,max:e.items.tempo.slider.max},on:{change:function(t){e.isPlaying&&(e.beater.tempo=e.items.tempo.value)}},model:{value:e.items.tempo.value,callback:function(t){e.$set(e.items.tempo,"value",t)},expression:"items.tempo.value"}})],1)],1),i("v-row",{attrs:{"no-gutters":"",align:"center"}},[i("v-col",{staticClass:"musisync",attrs:{cols:"auto"}},[i("span",[e._v("拍子")])]),i("v-col",{staticStyle:{"max-width":"50%"},attrs:{cols:"auto"}},[Number.isInteger(e.items.timeSignature.value)?i("v-select",{staticClass:"ml-2 mr-2 mt-0 mb-1",attrs:{items:e.items.timeSignature.select,outlined:"",suffix:"/4",dense:"","hide-details":""},model:{value:e.items.timeSignature.value,callback:function(t){e.$set(e.items.timeSignature,"value",t)},expression:"items.timeSignature.value"}}):i("v-text-field",{staticClass:"ml-2 mr-2 mt-0 mb-1",attrs:{autofocus:"",placeholder:"2+3",suffix:"/4","hide-details":"","append-icon":"mdi-chevron-up",dense:""},on:{focus:function(t){e.isMobile&&e.$emit("update:isVirtualKeyboardShown",!0)},blur:function(t){e.isMobile&&e.$emit("update:isVirtualKeyboardShown",!1)},"click:append":function(t){e.items.timeSignature.value=4}},model:{value:e.items.timeSignature.complexValue,callback:function(t){e.$set(e.items.timeSignature,"complexValue",t)},expression:"items.timeSignature.complexValue"}})],1)],1),i("v-divider"),i("v-card-subtitle",{staticClass:"pl-0"},[e._v("音量")]),e._l(e.volumes,(function(t){return i("v-row",{key:t.title,attrs:{"no-gutters":"",justify:"space-between",align:"center"}},[i("v-col",{staticClass:"musisync",attrs:{cols:"auto"}},[i("span",[e._v(e._s(t.icon||t.title))])]),i("v-col",[i("v-slider",{attrs:{dense:"",min:t.slider.min,max:t.slider.max,"hide-details":""},on:{change:function(e){t.metronomeNote.volume=t.value}},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"subItem.value"}})],1)],1)}))],2)],1)],1)},Ce=[],Se=(i("8ba4"),i("ac1f"),i("1276"),i("9029"));i("07ac");window.AudioContext=window.AudioContext||window.webkitAudioContext;var _e=function(){function e(t,i,a){Object(fe["a"])(this,e),this.beatInterval=t,this._volume=i/100,this.frequency=a}return Object(pe["a"])(e,[{key:"init",value:function(){var e=this.ctx;this.osc=e.createOscillator(),this.gain=e.createGain(),this.masterGain=e.createGain(),this.osc.frequency.value=this.frequency,this.gain.gain.value=this._volume,this.masterGain.gain.value=.1,this.osc.connect(this.gain),this.gain.connect(this.masterGain),this.masterGain.connect(e.destination),this.osc.start(e.currentTime)}},{key:"reserveBeat",value:function(e,t,i){var a=this.gain;this.beatInterval?e%this.beatInterval===0&&(a.gain.setValueAtTime(this._volume,t),a.gain.linearRampToValueAtTime(0,t+.05)):i||e||(a.gain.setValueAtTime(this._volume,t),a.gain.linearRampToValueAtTime(0,t+.05))}},{key:"audioContext",set:function(e){this.ctx=e,this.init()}},{key:"volume",set:function(e){this._volume=e/100}}]),e}(),Me=function(){function e(t){Object(fe["a"])(this,e),this.ctx=new AudioContext,this.metronomeNotes=t,this.currentTimeSignature=0,this.current48Beat=0,this.currentSignatureIndex=0,this.lastBeatTimeStamp=0,this.nextBeatTimeStamp=0,this.baseTimeStamp=0,this.tempo=60,this.signature=[4],this.intervalId=0}return Object(pe["a"])(e,[{key:"start",value:function(e,t){this.ctx=new AudioContext,this.currentTimeSignature=0,this.current48Beat=0,this.currentSignatureIndex=0;var i=performance.now();this.lastBeatTimeStamp=i,this.nextBeatTimeStamp=i,this.baseTimeStamp=i-1e3*this.ctx.currentTime;for(var a=0,n=Object.values(this.metronomeNotes);a<n.length;a++){var s=n[a];s.audioContext=this.ctx}this.tempo=e,this.timeSignatureNumerator=t,this.scheduler.bind(this)(),this.intervalId=setInterval(this.scheduler.bind(this),500)}},{key:"stop",value:function(){this.ctx.close(),clearInterval(this.intervalId)}},{key:"currentTimeStamp",value:function(){return this.baseTimeStamp+1e3*this.ctx.currentTime}},{key:"timeStampToAudioContextTime",value:function(e){return(e-this.baseTimeStamp)/1e3}},{key:"nextNote",value:function(){var e=6e4/this.tempo;this.nextBeatTimeStamp+=e/12,this.current48Beat++,this.current48Beat%=12,this.current48Beat>0&&(this.currentTimeSignature++,this.currentSignatureIndex%=this.signature.length,this.currentTimeSignature>=this.signature[this.currentSignatureIndex]&&(this.currentTimeSignature=0,this.currentSignatureIndex++,this.currentSignatureIndex%=this.signature.length))}},{key:"scheduler",value:function(){var e=this.currentTimeStamp();while(this.nextBeatTimeStamp<e+700){for(var t=this.timeStampToAudioContextTime(this.nextBeatTimeStamp),i=0,a=Object.values(this.metronomeNotes);i<a.length;i++){var n=a[i];n.reserveBeat(this.current48Beat,t,this.currentTimeSignature)}this.nextNote()}}},{key:"timeSignatureNumerator",set:function(e){this.currentSignatureIndex=0,this.signature=e}}]),e}(),Te=n["a"].extend({props:{dark:Boolean,isVirtualKeyboardShown:Boolean},data:function(){return{isMobile:Se["isMobile"],title:"メトロノーム",active:!1,isPlaying:!1,items:{tempo:{title:"テンポ",value:60,slider:{min:40,max:300}},timeSignature:{title:"拍子",value:4,complexValue:"",select:[1,2,3,4,"複合"]}},volumes:{stress:{title:"強拍",value:100,slider:{min:0,max:100},metronomeNote:new _e(0,100,2400)},quarter:{title:"4分音符",icon:"q",value:50,slider:{min:0,max:100},metronomeNote:new _e(12,80,1200)},quaver:{title:"8分音符",icon:"e",value:0,metronomeNote:new _e(6,0,1200),slider:{min:0,max:100}},semiquaver:{title:"16分音符",icon:"s",value:0,metronomeNote:new _e(3,0,1200),slider:{min:0,max:100}},triplet:{title:"3連符",icon:"T",value:0,metronomeNote:new _e(4,0,1200),slider:{min:0,max:100}}},beater:void 0}},methods:{metroHandler:function(){this.isPlaying=!this.isPlaying,this.isPlaying?this.start():this.stop()},start:function(){this.beater=new Me({stress:this.volumes.stress.metronomeNote,quarter:this.volumes.quarter.metronomeNote,quaver:this.volumes.quaver.metronomeNote,semiquaver:this.volumes.semiquaver.metronomeNote,triplet:this.volumes.triplet.metronomeNote});var e=this.items.timeSignature.value,t=Number.isInteger(e)?[e]:(this.items.timeSignature.complexValue||"2+3").split(/[^\d]/).map((function(e){return Number(e)}));this.beater.start(this.items.tempo.value,t)},stop:function(){this.beater&&this.beater.stop()}},watch:{"items.timeSignature.value":function(){var e=this.items.timeSignature.value,t=Number.isInteger(e)?[e]:(this.items.timeSignature.complexValue||"2+3").split(/[^\d]/).map((function(e){return Number(e)}));this.isPlaying&&void 0!==this.beater&&(this.beater.timeSignatureNumerator=t)},"items.timeSignature.complexValue":function(){var e=(this.items.timeSignature.complexValue||"2+3").split(/[^\d]/).map((function(e){return Number(e)}));this.isPlaying&&void 0!==this.beater&&(this.beater.timeSignatureNumerator=e.filter(Boolean))},"items.tempo.value":function(e){void 0!==this.beater&&(this.beater.tempo=e)}}}),je=Te,$e=(i("13ae"),i("b0af")),Ve=i("99d9"),Ke=i("8654"),Ie=Object($["a"])(je,Ne,Ce,!1,null,null,null),Ae=Ie.exports;K()(Ie,{VBtn:O["a"],VCard:$e["a"],VCardSubtitle:Ve["a"],VCardText:Ve["b"],VCol:B["a"],VContainer:q["a"],VDivider:F["a"],VIcon:R["a"],VRow:z["a"],VSelect:U["a"],VSlider:X["a"],VTextField:Ke["a"]});var Pe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticClass:"overflow-y-auto",attrs:{dark:e.dark}},[i("v-container",{attrs:{fluid:""}},[i("v-row",{staticStyle:{},attrs:{justify:"space-around",align:"center","align-content":"center",dense:""}},[i("v-col",{staticClass:"text-center",attrs:{cols:"4"}},[i("span",[e._v("音色")]),i("v-divider",{attrs:{inset:"",vertical:""}})],1),i("v-col",{attrs:{cols:"8"}},[i("v-select",{staticClass:"mb-2",attrs:{items:e.waveforms.select,"item-text":"text","item-value":"waveform",value:e.waveform,dense:"","hide-details":"",dark:e.dark},on:{change:function(t){return e.$emit("update:waveform",t)}}})],1)],1),i("v-row",{staticStyle:{},attrs:{justify:"space-around",align:"center","align-content":"center",dense:""}},[i("v-col",{staticClass:"text-center",attrs:{cols:"4"}},[i("span",[e._v("音域")]),i("v-divider",{attrs:{inset:"",vertical:""}})],1),i("v-col",{attrs:{cols:"8"}},[i("v-slider",{attrs:{value:e.toneRange,min:"0",max:e.toneRanges.items.length-1,step:"1",ticks:"always","tick-labels":e.toneRanges.items,"tick-size":"4",color:"primary lighten-3","thumb-color":"primary"},on:{change:function(t){return e.$emit("update:toneRange",t)}}})],1)],1),i("v-row",{staticStyle:{},attrs:{justify:"space-around",align:"center","align-content":"center",dense:""}},[i("v-col",{staticClass:"text-center",attrs:{cols:"4"}},[i("span",[e._v("持続")]),i("v-divider",{attrs:{inset:"",vertical:""}})],1),i("v-col",{attrs:{cols:"8"}},[i("v-chip-group",{attrs:{mandatory:"",value:e.sustainMethod}},e._l(e.sustainMethods.items,(function(t,a){return i("v-chip",{key:a,attrs:{value:a,"active-class":"primary--text"},on:{click:function(t){return e.$emit("update:sustainMethod",a)}}},[e._v(e._s(t))])})),1)],1)],1),i("v-row",{staticStyle:{},attrs:{justify:"space-around",align:"center","align-content":"center",dense:""}},[i("v-col",{staticClass:"text-center",attrs:{cols:"4"}},[i("span",[e._v("調")]),i("v-divider",{attrs:{inset:"",vertical:""}})],1),i("v-col",{attrs:{cols:"8"}},[i("v-select",{staticClass:"mb-2",attrs:{items:e.scale.musicalKey.items,value:e.musicalKey,dense:"","hide-details":"",dark:e.dark},on:{change:function(t){return e.$emit("update:musicalKey",t)}}}),i("v-chip-group",{attrs:{mandatory:"",value:e.isMajor}},e._l(e.scale.scale.items,(function(t){return i("v-chip",{key:t.title,attrs:{value:t.value,"active-class":"primary--text"},on:{click:function(i){return e.$emit("update:isMajor",t.value)}}},[e._v(e._s(t.title))])})),1)],1)],1)],1)],1)},Oe=[],Be=n["a"].extend({props:{waveform:String,sustainMethod:String,toneRange:Number,isMajor:Boolean,musicalKey:String,dark:Boolean},data:function(){return{waveforms:{title:"波形",select:[{waveform:"sine",text:"正弦波"},{waveform:"square",text:"方形波"},{waveform:"triangle",text:"三角波"},{waveform:"sawtooth",text:"鋸波"}]},sustainMethods:{value:"momentary",items:{momentary:"瞬時",exclusive:"排他",alternative:"交互"}},scale:{title:"調",musicalKey:{items:["平均律","A","Bb","B","C","C#","D","Eb","E","F","F#","G","Ab"]},scale:{items:{major:{title:"長調",value:!0},minor:{title:"短調",value:!1}}}},toneRanges:{value:2,items:["低1","低2","中","高1","高2"]}}}}),qe=Be,Fe=i("cc20"),Re=i("ef9a"),Ee=Object($["a"])(qe,Pe,Oe,!1,null,null,null),De=Ee.exports;K()(Ee,{VCard:$e["a"],VChip:Fe["a"],VChipGroup:Re["a"],VCol:B["a"],VContainer:q["a"],VDivider:F["a"],VRow:z["a"],VSelect:U["a"],VSlider:X["a"]});var Ge=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{id:"harmony-display-card",dark:e.dark}},[i("div",{staticClass:"text-display"},[i("span",{staticClass:"chord-name text-h4 mr-5"},[e._v(e._s(""+e.matchChords[0].scaleName+e.matchChords[0].chordName))]),i("span",{staticClass:"chord-name text-body"},[e._v(e._s(e.relatedChordNames.join(", ")))])]),i("div",{attrs:{id:"harmony-display"}},[i("div",{staticClass:"white-keyboard"},e._l(e.whiteNoteNames,(function(t){return i("div",{key:t,staticClass:"white-key",class:[{primary:e.pressedNoteNames.includes(t)},e.dark?"darken-5":"lighten-5"],style:"border: solid 1px "+(e.dark?"white":"#1E1E1E"),attrs:{noteName:t}},[i("span",{staticClass:"note-text"},[e._v(e._s(e.displayCent?e.centDifference.get(t):t))])])})),0),i("div",{staticClass:"black-keyboard"},e._l(e.blackNoteNames,(function(t,a){return i("div",{key:a,class:[{primary:e.pressedNoteNames.includes(t)},e.dark?"darken-5":"lighten-5",""!==t?"black-key":"key-space"],style:"border: solid 1px "+(e.dark?"white":"#1E1E1E")+"; background-color: "+(e.dark?"#1E1E1E":"white"),attrs:{noteName:t}},[i("span",{staticClass:"note-text"},[e._v(e._s(e.displayCent?e.centDifference.get(t):t))])])})),0)])])},Le=[],Je=(i("b680"),["C","C#","D","Eb","E","F","F#","G","Ab","A","Bb","B"]),He={"":[0,4,7],m:[0,3,7],sus4:[0,5,7],sus2:[0,2,7],aug:[0,4,8],dim:[0,3,6],7:[0,4,7,10],m7:[0,3,7,10],M7:[0,4,7,11],"m7-5":[0,3,6,10],"7sus4":[0,5,7,10],mM7:[0,3,7,11],6:[0,4,7,9],m6:[0,3,7,9],"7-5":[0,4,6,10]};function We(e,t){var i=e in He?He[e]:[],a=Je.indexOf(t);return a>-1?i.map((function(e){return Je[(e+a)%Je.length]})):[]}var ze=n["a"].extend({name:"harmony-display",data:function(){return{whiteNoteNames:["C","D","E","F","G","A","B"],blackNoteNames:["","C#","Eb","","","F#","Ab","Bb",""]}},props:{matchChords:Array,isMajor:Boolean,musicalKey:String,displayCent:Boolean,dark:Boolean},computed:{relatedChordNames:function(){return this.matchChords.slice(1).map((function(e){return"".concat(e.scaleName).concat(e.chordName)}))},pressedNoteNames:function(){var e=this.matchChords[0];return We(e.chordName,e.scaleName)},centDifference:function(){var e,t=k(this.musicalKey,this.isMajor),i=new Map,a=Object(c["a"])(Je.keys());try{for(a.s();!(e=a.n()).done;){var n=e.value;i.set(Je[n],(Math.round(10*t[n])/10).toFixed(1))}}catch($t){a.e($t)}finally{a.f()}return i}},methods:{}}),Ue=ze,Xe=(i("82fe"),Object($["a"])(Ue,Ge,Le,!1,null,"1de9998a",null)),Ye=Xe.exports;K()(Xe,{VCard:$e["a"]});var Qe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{id:"harmony-display-card",dark:e.dark,height:"9rem"}},[i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-row",{staticStyle:{height:"5rem",width:"100%"},attrs:{"no-gutters":""}},[i("v-col",{staticStyle:{height:"100%"},attrs:{cols:"12"}},[i("canvas",{staticStyle:{border:"1px solid #ccc",height:"100%",width:"100%"},attrs:{id:"canvas",width:e.width,height:e.height}})])],1),i("v-row",{staticStyle:{height:"4rem"},attrs:{"no-gutters":"",align:"center","align-content":"center",justify:"center"}},[i("v-col",{attrs:{cols:"1","align-self":"center"}},[i("div",{staticStyle:{width:"100%","text-align":"center"}},[i("v-btn",{attrs:{depressed:"",text:"",outlined:"",small:"",icon:""},on:{click:e.drawHandler}},[i("v-icon",[e._v(" "+e._s(e.isDrawing?"mdi-pause":"mdi-play")+" ")])],1),i("v-btn",{attrs:{depressed:"",text:"",outlined:"",small:"",icon:""},on:{click:e.setMaxLevel}},[i("v-icon",[e._v(" mdi-reload ")])],1)],1)]),i("v-col",{attrs:{cols:"5.5"}},[i("v-slider",{attrs:{dense:"",min:1,max:10,label:"振幅倍率","hide-details":""},model:{value:e.yRatio,callback:function(t){e.yRatio=t},expression:"yRatio"}})],1),i("v-col",{attrs:{cols:"5.5"}},[i("v-slider",{attrs:{dense:"",step:"0.1",min:1,max:20,label:"時間倍率","hide-details":""},model:{value:e.xRatio,callback:function(t){e.xRatio=t},expression:"xRatio"}})],1)],1)],1)],1)},Ze=[],et=(i("4160"),i("13d5"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("159b"),n["a"].extend({props:{dark:Boolean,analyserNode:AnalyserNode},data:function(){return{dataArray:void 0,canvasCtx:void 0,width:0,height:0,isDrawing:!1,xRatio:1,yRatio:1,maxLevel:128}},methods:{start:function(){void 0!==this.analyserNode&&(this.analyserNode.fftSize=32768);var e=document.getElementById("canvas");this.canvasCtx=e.getContext("2d"),this.width=e.clientWidth,this.height=e.clientHeight,this.canvasCtx.clearRect(0,0,this.width,this.height),this.draw()},setMaxLevel:function(){this.maxLevel=void 0===this.dataArray?128:this.dataArray.reduce((function(e,t){return e>t?e:t}))},draw:function(){if(void 0!==this.analyserNode){var e=this.analyserNode.frequencyBinCount;this.dataArray=new Uint8Array(e),this.analyserNode.getByteTimeDomainData(this.dataArray);var t=this.canvasCtx,i=this.dataArray,a=this.maxLevel;if(i[0]>a)while(i[0]>=a)i=i.slice(1);while(i[0]<a||i[0]===a&&i[1]<a)i=i.slice(1);t.fillStyle="white",t.fillRect(0,0,this.width,this.height);var n=this.yRatio,s=this.height;t.strokeStyle="black",t.beginPath(),t.moveTo(0,(1-((i[0]-128)*n+128)/255)*s);var r=1*this.width/e*this.xRatio;i.forEach((function(e,i){var a=(1-((e-128)*n+128)/255)*s;t.lineTo(i*r,a)})),t.stroke(),t.strokeStyle="lightblue",t.beginPath(),t.moveTo(0,this.height/2),t.lineTo(this.width,this.height/2),t.stroke(),this.isDrawing&&requestAnimationFrame(this.draw)}},drawHandler:function(){this.isDrawing=!this.isDrawing,this.draw()}},mounted:function(){this.start()},watch:{analyserNode:function(){this.start()}}})),tt=et,it=Object($["a"])(tt,Qe,Ze,!1,null,null,null),at=it.exports;function nt(e,t){window.localStorage.setItem(e,JSON.stringify(t))}K()(it,{VBtn:O["a"],VCard:$e["a"],VCol:B["a"],VContainer:q["a"],VIcon:R["a"],VRow:z["a"],VSlider:X["a"]});var st=JSON.parse(window.localStorage.getItem("settings")),rt=JSON.parse(window.localStorage.getItem("settings")),ot=JSON.parse(window.localStorage.getItem("toneConfig")),lt=n["a"].extend({name:"App",components:{"piano-keyboard":ke,"metronome-card":Ae,"tonecolor-card":De,"harmony-display":Ye,oscilloscope:at},data:function(){var e,t,i,a,n,s,r,o,l,c,u,d;return{drawer:null,settings:{general:{title:"一般",active:!1,items:{autoKeySelect:{title:"調の自動選択",value:(null===st||void 0===st||null===(e=st.items)||void 0===e||null===(t=e.autoKeySelect)||void 0===t?void 0:t.value)||!0,switch:!0},displayCent:{title:"セント値を表示",value:(null===st||void 0===st||null===(i=st.items)||void 0===i||null===(a=i.displayCent)||void 0===a?void 0:a.value)||!1,switch:!0},baseFrequency:{title:"基本周波数",value:(null===st||void 0===st||null===(n=st.items)||void 0===n||null===(s=n.baseFrequency)||void 0===s?void 0:s.value)||442,slider:{min:435,max:445}},colorTheme:{title:"ダークモード",value:(null===st||void 0===st||null===(r=st.items)||void 0===r||null===(o=r.colorTheme)||void 0===o?void 0:o.value)||!1,switch:!0}}},toneColor:{title:"音形",active:!1,items:{attack:{title:"アタック",value:(null===rt||void 0===rt||null===(l=rt.items)||void 0===l||null===(c=l.attack)||void 0===c?void 0:c.value)||50,slider:{min:0,max:100}},release:{title:"リリース",value:(null===rt||void 0===rt||null===(u=rt.items)||void 0===u||null===(d=u.release)||void 0===d?void 0:d.value)||50,slider:{min:0,max:100}}}}},playingMidiNoteNumbers:[],toneConfig:{waveform:(null===ot||void 0===ot?void 0:ot.waveform)||"sine",sustainMethod:(null===ot||void 0===ot?void 0:ot.sustainMethod)||"momentary",isMajor:null==(null===ot||void 0===ot?void 0:ot.isMajor)||(null===ot||void 0===ot?void 0:ot.isMajor),musicalKey:(null===ot||void 0===ot?void 0:ot.musicalKey)||"平均律",toneRange:(null===ot||void 0===ot?void 0:ot.toneRange)||2},harmony:[{chordName:"",scaleName:""}],isVirtualKeyboardShown:!1,analyser:void 0}},watch:{playingMidiNoteNumbers:function(){var e=N(this.playingMidiNoteNumbers);e.length>0&&(this.harmony=e,this.settings.general.items.autoKeySelect.value&&(this.toneConfig.musicalKey=e[0].scaleName,this.toneConfig.isMajor=e[0].isMajor))},"settings.general":{handler:function(e){nt(e.title,e)},deep:!0},"settings.toneColor":{handler:function(e){nt(e.title,e)},deep:!0},toneConfig:{handler:function(e){nt("toneConfig",e)},deep:!0}}}),ct=lt,ut=i("553a"),dt=Object($["a"])(ct,se,re,!1,null,"8dce4432",null),mt=dt.exports;K()(dt,{VCol:B["a"],VContainer:q["a"],VFooter:ut["a"],VRow:z["a"]});var ht=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",[i("router-view")],1)},vt=[],ft=i("bfc7"),pt=(i("be0f"),{});n["a"].use(ft["a"],{globalOptions:{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]}});var yt=pt,gt=Object($["a"])(yt,ht,vt,!1,null,null,null),bt=gt.exports;K()(gt,{VContainer:q["a"]});var wt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-row",{directives:[{name:"katex",rawName:"v-katex:auto",arg:"auto"}]},[i("v-col",{attrs:{cols:"12"}},[i("h3",[e._v("どのようにうなりは生じるか")]),i("p",[e._v("うなりについて、考えます。")]),i("p",[e._v("うなりは、このレベルの対象読者であれば物理基礎で習って、理解していると思いますが、数式で証明していきます。 数式と聞いて身構える必要はありません。三角関数の和積の公式だけで証明できます。実質的には三角関数の加法定理だけで証明できることになります。")]),i("p",[e._v("まず、状況を考えます。 ここでは、同じ場所から、同じ方向へ同じ速さで進む、２つの異なる周波数の波の伝搬を考えます。 同じスピーカーから二つの音を出せばあり得ることです（そもそもスピーカー内部の電気信号の時点で干渉が起きます）。")]),i("p",[e._v("それぞれの波を$w_1$と$w_2$とし、周波数は$f_1$、$f_2$とし、どちらも$\\sin$波とします。 波には干渉という性質があり、全ての位置での波は、それぞれの重ね合わせで表されるので $$ \\begin{aligned} w &= w_1 + w_2 \\\\ &= \\sin(2\\pi f_1 t) + \\sin(2\\pi f_2 t) \\\\ &= 2\\sin\\left(2\\pi \\cfrac{f_1+f_2}{2} t\\right) \\cos\\left(2\\pi \\cfrac{f_1-f_2}{2} t\\right) \\end{aligned} $$ となります。積和の法則覚えていますか？")]),i("p",[e._v("つまり、周波数$f_1$と$f_2$の平均$(f_1+f_2)/2$の音が、その音量をこれらの周波数差の半分の周波数で変化させながら鳴ると言いそうになります。 しかし、$\\cos$はマイナス側にもいきますが、振幅はマイナスにはなりませんから、その絶対値で変化します。 $\\cos\\left(2\\pi \\frac{f_1-f_2}{2} t\\right)$がプラス側に大きくなったときはもちろん、マイナス側に大きくなったときにも振幅は大きくなるということです。 $\\cos$がマイナスの時、$\\sin$が上下反転したようになり、$\\sin$がマイナスに行くときに、その籍としてはプラス側に行くため、このようになります。")]),i("p",[e._v("周波数差がマイナスになる$f_2 > f_1$のときは、$\\cos$が逆回転になるだけで、偶関数ですから、結局関係ありません。 したがって、実質的なうなりの周波数は、$\\left|\\cos\\left(2\\pi \\frac{|f_1-f_2|}{2} t\\right)\\right|$の周波数と等しくなり、$\\cos$の周波数の倍の$|f_1-f_2|$と言えます。 物理基礎で習った内容と一致しましたでしょうか。")]),i("p",[e._v("周波数の違う二つの音を鳴らせば、その差の分だけうなることがわかりました。 しかし、1秒間に何十回も何百回もうなれば、それはもう、うなりとは認識できません。 漕ぎはじめの自転車のライトはチカチカしますが、速度が出てくるとずっとついているように見えますよね。 ゆっくりと振幅が変化することによって、うなりは聞き取ることができるので、同じような高さの音同士の間（ユニゾンで演奏しているときなど）でうなりは顕著になります。")]),i("p",[e._v("それから、和音のときも、含まれる倍音との差でうなりが生じます。 ドとソを鳴らした時を考えましょう。 この二つは完全5度と、結構離れているので、先ほどの理屈から言えばうなりは聞こえないはずです。 しかし、ドの自然倍音に含まれるソの音と、鳴らしたソの音の間で周波数が異なれば、やはりうなりとして聞こえてきます。 和音を綺麗にハモらせるなら、ドに含まれる自然倍音と同じ高さの音で演奏せねばらなず、これが純正律へとつながっていきます。")]),i("h4",[e._v("ポイント")]),i("ul",[i("li",[e._v("うなりは近い周波数の波同士の干渉によって生じる")]),i("li",[e._v("うなりの周波数は互いの周波数の差")]),i("li",[e._v("和音の場合、自然倍音とも干渉し、うなりが生じる")])]),i("router-link",{attrs:{to:"/learning/level3/2"}},[e._v("次のページ：純正律再考")])],1)],1)},xt=[],kt={},Nt=Object($["a"])(kt,wt,xt,!1,null,null,null),Ct=Nt.exports;K()(Nt,{VCol:B["a"],VRow:z["a"]}),n["a"].use(ne["a"]);var St=[{path:"/",name:"Harmony",component:mt},{path:"/learning",component:bt,children:[{path:"",component:function(){return i.e("chunk-2d0e2921").then(i.bind(null,"7eeb"))}},{path:"level1/1",component:function(){return i.e("chunk-5f4e2479").then(i.bind(null,"2a93"))}},{path:"level1/2",component:function(){return i.e("chunk-dab9ea0e").then(i.bind(null,"273b"))}},{path:"level2/1",component:function(){return i.e("chunk-70765d52").then(i.bind(null,"be96"))}},{path:"level2/2",component:function(){return i.e("chunk-2d0a32e5").then(i.bind(null,"00a0"))}},{path:"level2/3",component:function(){return i.e("chunk-0d7e7468").then(i.bind(null,"43eb"))}},{path:"level3/1",component:Ct},{path:"level3/2",component:function(){return i.e("chunk-2d22dbab").then(i.bind(null,"f979"))}},{path:"level3/3",component:function(){return i.e("chunk-2d2228ce").then(i.bind(null,"cea7"))}},{path:"level3/4",component:function(){return i.e("chunk-2d0cfde9").then(i.bind(null,"660c"))}},{path:"level4/1",component:function(){return i.e("chunk-2d0da2e9").then(i.bind(null,"6b07"))}},{path:"level4/2",component:function(){return i.e("chunk-2d0c4e26").then(i.bind(null,"3d76"))}}]},{path:"/about",name:"About",component:function(){return i.e("about").then(i.bind(null,"f820"))}}],_t=new ne["a"]({mode:"hash",base:"",routes:St,scrollBehavior:function(e,t,i){return i||{x:0,y:0}}}),Mt=_t,Tt=i("f309");n["a"].use(Tt["a"]);var jt=new Tt["a"]({});n["a"].config.productionTip=!1,new n["a"]({router:Mt,vuetify:jt,render:function(e){return e(ie)}}).$mount("#app")},e897:function(e,t,i){}});
//# sourceMappingURL=app.7768f271.js.map